<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Todo App</title>
        <style>
    /* Your CSS styles here */
  </style>
    </head>
    <body>
        <h1>Todo List</h1>
        <input type="text" id="taskInput" placeholder="Add a new task">
        <button onclick="addTodo()">Add</button>

        <ul id="todoList"></ul>

        <script>
    async function fetchTodos() {
      const response = await fetch('http://localhost:3000/products');
      const data = await response.json();
      return data;
    }

    async function renderTodos() {
      const todos = await fetchTodos();
      const todoList = document.getElementById('todoList');
      todoList.innerHTML = '';

      todos.forEach(todo => {
        const listItem = document.createElement('li');
        listItem.innerHTML = `
          <span>${todo.name}</span>
          <button onclick="editTodo('${todo.id}')">Edit</button>
          <button type="button" onclick="deleteTodo('${todo.id}')">Delete</button>
        `;
        todoList.appendChild(listItem);
      });
    }

    async function addTodo() {
      const taskInput = document.getElementById('taskInput');
      const task = taskInput.value;
      if (task.trim() === '') return;

      await fetch('http://localhost:3000/products', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ task, completed: false })
      });

      taskInput.value = '';
      await renderTodos();
    }

    async function editTodo(id) {
      const newTask = prompt('Enter the new task:');
      if (newTask === null || newTask.trim() === '') return;

      await fetch(`http://localhost:3000/products/${id}`, {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ name: newTask })
      });

      await renderTodos();
    }

    async function deleteTodo(id) {

  await fetch(`http://localhost:3000/products/${id}`, {
    method: 'DELETE'
  });


  // Ngăn chặn hành động mặc định của nút submit (tải lại trang)
  event.preventDefault();
}


    renderTodos();
  </script>
    </body>
</html>